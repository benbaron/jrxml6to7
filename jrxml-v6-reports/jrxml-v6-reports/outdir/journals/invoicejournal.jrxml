<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<jasperReport name="InvoiceJournal" resourceBundle="book">
  <parameter class="net.sf.jasperreports.engine.JasperReport" name="Report"/>
  <parameter class="java.util.HashMap" name="Parameters"/>
  <!-- Declared fields in the report. -->
  <field class="java.lang.Integer" name="invoice.number"/>
  <field class="java.lang.String" name="invoice.customernr"/>
  <field class="java.lang.String" name="invoice.customername"/>
  <field class="java.lang.String" name="invoice.date"/>
  <field class="java.math.BigDecimal" name="invoice.sum"/>
  <field class="java.math.BigDecimal" name="invoice.tax"/>
  <field class="java.lang.String" name="invoice.currency"/>
  <field class="java.math.BigDecimal" name="invoice.currencyrate"/>
  <field class="java.math.BigDecimal" name="invoice.localsum"/>
  <field class="net.sf.jasperreports.engine.JRDataSource" name="journal.rows"/>
  <!-- The sum. -->
  <variable calculation="Sum" class="java.math.BigDecimal" name="sum" resetType="Report">
    <expression><![CDATA[$F{invoice.localsum}]]></expression>
    <initialValueExpression><![CDATA[new BigDecimal(0.0)]]></initialValueExpression>
  </variable>
  <columnHeader height="30">
    <element height="1" kind="line" width="510" x="20" y="23"/>
    <!-- Column 1 -->
    <element height="24" kind="textField" width="80" x="20" y="0">
      <expression><![CDATA[$R{invoicejournal.column.1}]]></expression>
    </element>
    <element height="24" kind="textField" width="80" x="80" y="0">
      <expression><![CDATA[$R{invoicejournal.column.2}]]></expression>
    </element>
    <element height="24" kind="textField" width="70" x="140" y="0">
      <expression><![CDATA[$R{invoicejournal.column.3}]]></expression>
    </element>
    <element hTextAlign="Left" height="24" kind="textField" width="50" x="270" y="0">
      <expression><![CDATA[$R{invoicejournal.column.4}]]></expression>
    </element>
    <element hTextAlign="Left" height="24" kind="textField" width="50" x="320" y="0">
      <expression><![CDATA[$R{invoicejournal.column.5}]]></expression>
    </element>
    <element hTextAlign="Right" height="24" kind="textField" width="80" x="370" y="0">
      <expression><![CDATA[$R{invoicejournal.column.6}]]></expression>
    </element>
    <element hTextAlign="Right" height="24" kind="textField" width="80" x="450" y="0">
      <expression><![CDATA[$R{invoicejournal.column.7}]]></expression>
    </element>
  </columnHeader>
  <detail>
    <band height="75" splitType="Stretch">
      <!-- Invoice number -->
      <element height="14" kind="textField" width="30" x="20" y="0">
        <expression><![CDATA[$F{invoice.number}]]></expression>
      </element>
      <!-- Customer number -->
      <element height="14" kind="textField" width="80" x="80" y="0">
        <expression><![CDATA[$F{invoice.customernr}]]></expression>
      </element>
      <!-- Customer name -->
      <element height="14" kind="textField" width="150" x="140" y="0">
        <expression><![CDATA[$F{invoice.customername}]]></expression>
      </element>
      <!-- Invoice date -->
      <element hTextAlign="Right" height="14" kind="textField" width="80" x="370" y="0">
        <expression><![CDATA[$F{invoice.date}]]></expression>
      </element>
      <!-- Invoice currency -->
      <element hTextAlign="Right" height="14" kind="textField" width="80" x="450" y="0">
        <expression><![CDATA[$F{invoice.currency}]]></expression>
      </element>
      <!-- Order rows -->
      <element height="0" kind="subreport" usingCache="false" width="555" x="0" y="12">
        <parametersMapExpression><![CDATA[new java.util.HashMap() {{ put("invoice.customernr", $F{invoice.number}); }}]]></parametersMapExpression>
        <dataSourceExpression><![CDATA[$F{journal.rows}]]></dataSourceExpression>
        <expression><![CDATA[$P{Report}]]></expression>
      </element>
      <element height="50" kind="frame" width="555" x="0" y="12">
        <element height="1" kind="line" width="450" x="80" y="0"/>
        <element hTextAlign="Left" height="12" kind="textField" width="120" x="350" y="0">
          <expression><![CDATA[$R{invoicejournal.sum}]]></expression>
        </element>
        <element hTextAlign="Right" height="12" kind="textField" pattern="#,##0.00" width="60" x="470" y="0">
          <expression><![CDATA[$F{invoice.sum}]]></expression>
        </element>
        <element hTextAlign="Left" height="12" kind="textField" width="120" x="350" y="12">
          <expression><![CDATA[$R{invoicejournal.tax}]]></expression>
        </element>
        <element hTextAlign="Right" height="12" kind="textField" pattern="#,##0.00" width="60" x="470" y="12">
          <expression><![CDATA[$F{invoice.tax}]]></expression>
        </element>
        <element hTextAlign="Left" height="12" kind="textField" width="120" x="350" y="24">
          <expression><![CDATA[$R{invoicejournal.currencyrate}]]></expression>
        </element>
        <element hTextAlign="Right" height="12" kind="textField" pattern="#,##0.00000" width="60" x="470" y="24">
          <expression><![CDATA[$F{invoice.currencyrate}]]></expression>
        </element>
        <element hTextAlign="Left" height="12" kind="textField" width="120" x="350" y="36">
          <expression><![CDATA[$R{invoicejournal.totalsum}]]></expression>
        </element>
        <element hTextAlign="Right" height="12" kind="textField" pattern="#,##0.00" width="60" x="470" y="36">
          <expression><![CDATA[$F{invoice.localsum}]]></expression>
        </element>
      </element>
    </band>
  </detail>
  <summary height="20">
    <element backcolor="#000000" height="2" kind="rectangle" width="510" x="20" y="0"/>
    <element height="14" kind="textField" width="250" x="20" y="2">
      <expression><![CDATA[$R{invoicejournal.totalsum}]]></expression>
    </element>
    <!-- Total sum-->
    <element blankWhenNull="true" hTextAlign="Right" height="14" kind="textField" pattern="#,##0.00" width="80" x="450" y="2">
      <expression><![CDATA[$V{sum} != null ? $V{sum} : new BigDecimal(0.0)]]></expression>
    </element>
  </summary>
</jasperReport>
